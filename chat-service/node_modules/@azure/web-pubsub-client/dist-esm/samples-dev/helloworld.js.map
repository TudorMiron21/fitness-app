{"version":3,"file":"helloworld.js","sourceRoot":"","sources":["../../samples-dev/helloworld.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @summary Basic usage of web-pubsub-client\n */\n\nimport {\n  WebPubSubClient,\n  WebPubSubClientCredential,\n  GetClientAccessUrlOptions,\n} from \"@azure/web-pubsub-client\";\nimport { WebPubSubServiceClient } from \"@azure/web-pubsub\";\n\nrequire(\"dotenv\").config();\n\nconst hubName = \"sample_chat\";\nconst groupName = \"testGroup\";\nconst serviceClient = new WebPubSubServiceClient(process.env.WPS_CONNECTION_STRING!, hubName);\n\nconst fetchClientAccessUrl = async (_: GetClientAccessUrlOptions) => {\n  return (\n    await serviceClient.getClientAccessToken({\n      roles: [`webpubsub.joinLeaveGroup.${groupName}`, `webpubsub.sendToGroup.${groupName}`],\n    })\n  ).url;\n};\n\nasync function main() {\n  let client = new WebPubSubClient({\n    getClientAccessUrl: fetchClientAccessUrl,\n  } as WebPubSubClientCredential);\n\n  client.on(\"connected\", (e) => {\n    console.log(`Connection ${e.connectionId} is connected.`);\n  });\n\n  client.on(\"disconnected\", (e) => {\n    console.log(`Connection disconnected: ${e.message}`);\n  });\n\n  client.on(\"server-message\", (e) => {\n    if (e.message.data instanceof ArrayBuffer) {\n      console.log(`Received message ${Buffer.from(e.message.data).toString(\"base64\")}`);\n    } else {\n      console.log(`Received message ${JSON.stringify(e.message.data)}`);\n    }\n  });\n\n  client.on(\"group-message\", (e) => {\n    if (e.message.data instanceof ArrayBuffer) {\n      console.log(\n        `Received message from ${e.message.group} ${Buffer.from(e.message.data).toString(\n          \"base64\",\n        )}`,\n      );\n    } else {\n      console.log(`Received message from ${e.message.group} ${JSON.stringify(e.message.data)}`);\n    }\n  });\n\n  await client.start();\n\n  await client.joinGroup(groupName);\n  await client.sendToGroup(groupName, \"hello world\", \"text\", {\n    fireAndForget: true,\n  });\n  await client.sendToGroup(groupName, { a: 12, b: \"hello\" }, \"json\");\n  await client.sendToGroup(groupName, \"hello json\", \"json\");\n  var buf = Buffer.from(\"aGVsbG9w\", \"base64\");\n  await client.sendToGroup(\n    groupName,\n    buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength),\n    \"binary\",\n  );\n  await delay(1000);\n  await client.stop();\n}\n\nmain().catch((e) => {\n  console.error(\"Sample encountered an error\", e);\n  process.exit(1);\n});\n\nfunction delay(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n"]}